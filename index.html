<script>
    let db = []; let p = 1; const sz = 20;

    function render(list) {
        const grid = document.getElementById('grid');
        grid.innerHTML = list.map(m => `
            <a href="download.html?id=${m.id}" class="movie-item">
                <img src="${m.img}" onerror="this.src='https://via.placeholder.com/60x80?text=Poster'">
                <div class="movie-info">
                    <div class="movie-name">${m.title}</div>
                    <span class="dl-tag">HD Rip</span> <span class="dl-tag" style="background:#00ff00">Free Download</span>
                </div>
            </a>
        `).join('');
    }

    function s() {
        let q = document.getElementById('srch').value.toLowerCase();
        let filtered = db.filter(x => x.title.toLowerCase().includes(q));
        render(filtered.slice(0, 20));
    }

    function cp(v) { 
        p += v; if(p<1) p=1; 
        document.getElementById('pnum').innerText = "Page " + p; 
        render(db.slice((p-1)*sz, p*sz)); 
        window.scrollTo(0,0); 
    }

    fetch('news.json?v=' + Date.now())
        .then(r => r.json())
        .then(data => {
            db = data.news_items;
            document.getElementById('status').style.display = 'none';
            render(db.slice(0, sz));
        });
</script>
