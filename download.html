<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IDM Downloader | AllMoviesHD</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #121212; color: white; margin: 0; display: flex; align-items: center; justify-content: center; height: 100vh; }
        /* IDM Style Box */
        .idm-box { background: #e0e0e0; color: #333; width: 450px; border: 2px solid #666; border-radius: 5px; box-shadow: 10px 10px 20px rgba(0,0,0,0.5); font-size: 13px; text-align: left; }
        .idm-header { background: linear-gradient(to bottom, #eeeeee, #cccccc); padding: 5px 10px; border-bottom: 1px solid #999; font-weight: bold; display: flex; justify-content: space-between; }
        .idm-body { padding: 15px; }
        .idm-row { display: flex; margin-bottom: 10px; }
        .idm-label { width: 100px; color: #555; }
        .idm-input { flex: 1; background: white; border: 1px solid #999; padding: 3px 5px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; }
        .idm-footer { background: #f0f0f0; padding: 10px; text-align: right; border-top: 1px solid #ccc; }
        .idm-btn { padding: 5px 20px; margin-left: 5px; border: 1px solid #777; background: #e1e1e1; cursor: pointer; font-size: 12px; }
        .idm-btn-main { background: #4caf50; color: white; border: 1px solid #388e3c; font-weight: bold; }
        
        /* Progress Bar */
        #download-ui { display: none; }
        .progress-container { width: 100%; background: #ddd; height: 20px; border: 1px solid #999; margin-top: 10px; position: relative; }
        .progress-fill { width: 0%; background: #000080; height: 100%; transition: 0.1s; }
        .pct-text { position: absolute; width: 100%; text-align: center; color: white; mix-blend-mode: difference; font-weight: bold; line-height: 20px; }
    </style>
</head>
<body>

<div class="idm-box">
    <div class="idm-header">
        <span>Internet Download Manager</span>
        <span style="cursor:pointer">X</span>
    </div>
    
    <div class="idm-body">
        <div class="idm-row">
            <div class="idm-label">URL:</div>
            <div class="idm-input" id="m-url">http://server1.allmovieshd.hindi/file.mp4</div>
        </div>
        <div class="idm-row">
            <div class="idm-label">Category:</div>
            <div class="idm-input">Videos</div>
        </div>
        <div class="idm-row">
            <div class="idm-label">Save As:</div>
            <div class="idm-input" id="m-title" style="font-weight:bold;">Movie_HD.mp4</div>
        </div>

        <div id="download-ui">
            <div id="status-text">Downloading file...</div>
            <div class="progress-container">
                <div class="pct-text" id="pct">0%</div>
                <div class="progress-fill" id="fill"></div>
            </div>
            <div style="display:flex; justify-content:space-between; margin-top:5px;">
                <span id="speed">Speed: 8.5 MB/s</span>
                <span id="time">Time left: 00:01:24</span>
            </div>
        </div>
    </div>

    <div class="idm-footer" id="footer-btns">
        <button class="idm-btn idm-btn-main" onclick="startIDM()">Start Download</button>
        <button class="idm-btn" onclick="window.history.back()">Cancel</button>
    </div>
</div>

<script>
    const params = new URLSearchParams(window.location.search);
    const mID = params.get('movieid');

    async function setup() {
        const res = await fetch('news.json');
        const data = await res.json();
        const movie = data.news_items[mID];
        if(movie) {
            document.getElementById('m-title').innerText = movie.title.replace(/\s+/g, '_') + ".mp4";
            document.getElementById('m-url').innerText = "http://allmovieshd.cdn/" + movie.title.substring(0,10) + "/stream.mp4";
        }
    }

    function startIDM() {
        document.getElementById('download-ui').style.display = 'block';
        document.getElementById('footer-btns').style.display = 'none';
        
        let fill = document.getElementById('fill');
        let pct = document.getElementById('pct');
        let w = 0;

        let interval = setInterval(() => {
            w += Math.random() * 3;
            if (w > 100) w = 100;
            fill.style.width = w + "%";
            pct.innerText = Math.floor(w) + "%";

            if(w >= 100) {
                clearInterval(interval);
                document.getElementById('status-text').innerText = "Download Complete!";
                
                // Asli Download Trigger
                const movieName = document.getElementById('m-title').innerText;
                const finalLink = "https://www.google.com/search?q=intitle:index.of+mp4+" + encodeURIComponent(movieName) + "&btnI=1";
                window.location.href = finalLink;
            }
        }, 150);
    }
    setup();
</script>

</body>
</html>
